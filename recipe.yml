name : Install Redis on Ubunutu 16.04
desc : The recipe installs the redis service to Ubunutu 16.04 box  
logo_url: https://raw.githubusercontent.com/tanmally/mongo-ubuntu-16/master/logo/mongo.jpg
tags:
    - mongo db
    - install
    - latest
    - Ubunutu 16.04
 
task:

  - name: Install mongo db server
    cmd:
        - export DEBIAN_FRONTEND=noninteractive
        - apt-key -y adv --keyserver hkp://keyserver.ubuntu.com:80 --recv EA312927
        - echo "deb http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.2 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.2.list
        - apt-get update  
        - apt-get install -y mongodb-org
        - systemctl start mongod
        - systemctl enable mongod
        - echo Done installing mongo db server       
          
  - name: Copy setup script file 
    copy: 
         src_file: script/db_config.sh
         target_dir: /opt/mongo/script/
         target_file_name : db_config.sh

  - name: Run mongo db auth setup script
    cmd:
        - export DEBIAN_FRONTEND=noninteractive
        - chmod +x /opt/mongo/script/db_config.sh
        - /opt/mongo/script/db_config.sh
        - rm -f /opt/mongo/script/db_config.sh
        - echo Done running mongo db auth setup
    vars:
        - SKIP_AUTH_SETUP
        - MONGODB_USERNAME
        - MONGODB_PASSWORD
  
